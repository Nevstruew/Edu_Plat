{% extends 'base.html' %}

{% block content %}
<div class="container mt-4">
    <div class="card mb-4">
        <div class="card-body">
            <h1 class="card-title">{{ assignment.title }}</h1>
            <p class="text-muted">
                –£—Ä–æ–∫: <a href="{% url 'lesson_detail' assignment.lesson.pk %}">{{ assignment.lesson.title }}</a>
            </p>
            <div class="assignment-description">
                <h5>üìã –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è:</h5>
                <p>{{ assignment.description|linebreaks }}</p>
            </div>
        </div>
    </div>

    {% if user == assignment.lesson.created_by %}
    <div class="teacher-section mt-4">
        <div class="card border-warning">
            <div class="card-header bg-warning text-dark">
                <h5 class="mb-0">üë®‚Äçüè´ –ü–∞–Ω–µ–ª—å –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è</h5>
            </div>
            <div class="card-body">
                <p>–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –æ—Ç–≤–µ—Ç—ã —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –Ω–∞ —ç—Ç–æ –∑–∞–¥–∞–Ω–∏–µ:</p>
                <a href="{% url 'assignment_submissions' assignment.id %}" class="btn btn-warning">
                    üìä –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—Ç–≤–µ—Ç—ã ({{ assignment.submissions.count }})
                </a>
            </div>
        </div>
    </div>
    {% endif %}

    <div class="submission-section">
        <h3>üí¨ –í–∞—à –æ—Ç–≤–µ—Ç</h3>
        
        {% if user.is_authenticated %}
            {% if user_submission %}
                <div class="alert alert-info">
                    <h5>‚úÖ –í–∞—à –æ—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω</h5>
                    <p><strong>–°—Ç–∞—Ç—É—Å:</strong> 
                        {% if user_submission.grade %}
                            –û—Ü–µ–Ω–µ–Ω–æ ({{ user_submission.grade }}/100)
                        {% else %}
                            ‚è≥ –ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ
                        {% endif %}
                    </p>
                    <a href="{% url 'submission_detail' user_submission.id %}" class="btn btn-outline-primary">
                        –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–≤–æ–π –æ—Ç–≤–µ—Ç
                    </a>
                </div>
            {% elif can_submit %}
                <div class="d-grid gap-2">
                    <a href="{% url 'submit_assignment' assignment.id %}" class="btn btn-success btn-lg">
                        ‚úèÔ∏è –û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –∑–∞–¥–∞–Ω–∏–µ
                    </a>
                </div>
            {% endif %}
        {% else %}
            <div class="alert alert-warning">
                <a href="{% url 'login' %}" class="alert-link">–í–æ–π–¥–∏—Ç–µ</a>, —á—Ç–æ–±—ã –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –∑–∞–¥–∞–Ω–∏–µ.
            </div>
        {% endif %}
    </div>

    <a href="{% url 'lesson_detail' assignment.lesson.pk %}" class="btn btn-secondary mt-3">
        ‚Üê –ù–∞–∑–∞–¥ –∫ —É—Ä–æ–∫—É
    </a>
</div>
{% endblock %}